I"
<blockquote>
  <p>接上一篇，大早上试下 Calico，从目前的各种评论上来看 Calico 的性能要更好些，不过由于是纯三层的解决方案，某些用到二层的应用可能无法使用，不过目前还没遇到过，个人理解这种情况应该不多</p>
</blockquote>

<h3 id="一环境准备">一、环境准备</h3>

<p>首先有个 kubernetes 集群，集群网络处于未部署状态，集群信息如下</p>

<table>
  <thead>
    <tr>
      <th>IP地址</th>
      <th>节点</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>192.168.1.101</td>
      <td>master</td>
    </tr>
    <tr>
      <td>192.168.1.102</td>
      <td>node,etcd(单点)</td>
    </tr>
    <tr>
      <td>192.168.1.103</td>
      <td>node</td>
    </tr>
  </tbody>
</table>

<h3 id="二开搞">二、开搞</h3>

<p>至于 kubernetes 集群创建实在不想啰嗦，具体参考上一篇博客</p>

<p>Calico 官方提供了很好的文档支持，<a href="http://docs.projectcalico.org/v1.6/getting-started/kubernetes/">在这里</a> 基本能找到所有的参考教程，以下直接照着官方文档来</p>

<p>首先把 Calico 的 yaml 下载下来，这里采用官方文档 kubernetes 页面的 yaml，<strong>非 kubeadm 的</strong>，kubeadm 页面的 yaml 里面 多了创建 etcd 集群信息啥的，没什么卵用</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget http://docs.projectcalico.org/v1.6/getting-started/kubernetes/installation/hosted/calico.yaml
</code></pre></div></div>

<p>编辑 <code class="highlighter-rouge">calico.yaml</code>，修改 etcd 地址</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vim calico.yaml
<span class="c"># 将 etcd_endpoints 修改掉即可</span>
etcd_endpoints: <span class="s2">"http://192.168.1.102:2379"</span>
</code></pre></div></div>

<p>然后创建网络</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl create <span class="nt">-f</span> calico.yaml
</code></pre></div></div>

<p>创建完成后如下</p>

<p><img src="https://cdn.oss.link/markdown/ub8yg.jpg" alt="Calico" /></p>

<p>节点测试如下</p>

<p><img src="https://cdn.oss.link/markdown/p7zlt.jpg" alt="all node" /></p>

<p><img src="https://cdn.oss.link/markdown/ybdw5.jpg" alt="node2" /></p>

<p><img src="https://cdn.oss.link/markdown/3qm8t.jpg" alt="node3" /></p>

<p><strong>更细节的性能体现等可参考 <a href="http://blog.dataman-inc.com/shurenyun-docker-133/">将Docker网络方案进行到底</a></strong></p>

<p>转载请注明出处，本文采用 <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/">CC4.0</a> 协议授权</p>
:ET