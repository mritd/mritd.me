I"İ$<blockquote>
  <p>æŠ˜è…¾ Go å·²ç»æœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œæœ€è¿‘åœ¨ç”¨ Go å†™ç‚¹ web çš„ä¸œè¥¿ï¼›åœ¨æ­å»ºè„šæ‰‹æ¶çš„è¿‡ç¨‹ä¸­æ€»æ˜¯æœ‰ç‚¹ä¸é€‚åº”ï¼Œå°¤å…¶å¯¹å¯æ‰©å±•æ€§ä¸Šæ€»æ˜¯æ„Ÿè§‰æ²¡æœ‰ Java é‚£ä¹ˆé¡ºæ‰‹ï¼›ç´¢æ€§çœ‹äº†ä¸‹ coredns çš„æºç ï¼Œæœ€åè¿½è¸ªåˆ° caddy æºç ï¼›çªç„¶å‘ç°ä»–ä»¬å¯¹ä»£ç å†…çš„ plugin æœºåˆ¶æœ‰ä¸€äº›éªšå¥—è·¯ï¼Œè¿™é‡Œç´¢æ€§è®°å½•ä¸€ä¸‹</p>
</blockquote>

<h3 id="ä¸€é—®é¢˜ç”±æ¥">ä¸€ã€é—®é¢˜ç”±æ¥</h3>

<p>çºµè§‚ç°åœ¨æ‰€æœ‰çš„ Go web æ¡†æ¶ï¼Œåœ¨æ–‡æ¡£ä¸Šå¯ä»¥çœ‹åˆ°ä½¿ç”¨æ–¹å¼å¾ˆç®€æ˜ï¼›éå¸¸ç¬¦åˆæˆ‘å¯¹ Go çš„ä¸€è´¯æ„Ÿå—: â€œæ‰€å†™å³æ‰€å¾—â€ï¼›å°±æ‹¿ Gin è¿™ä¸ªæ¥è¯´ï¼Œåœ¨ README.md ä¸Šå¯ä»¥å¾ˆè½»æ¾çš„çœ‹åˆ° <code class="highlighter-rouge">engine</code> æˆ–è€…è¯´ <code class="highlighter-rouge">router</code> è¿™ç©æ„çš„ä½¿ç”¨ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ ·:</p>

<div class="language-golang highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="c">// Disable Console Color</span>
	<span class="c">// gin.DisableConsoleColor()</span>

	<span class="c">// Creates a gin router with default middleware:</span>
	<span class="c">// logger and recovery (crash-free) middleware</span>
	<span class="n">router</span> <span class="o">:=</span> <span class="n">gin</span><span class="o">.</span><span class="n">Default</span><span class="p">()</span>

	<span class="n">router</span><span class="o">.</span><span class="n">GET</span><span class="p">(</span><span class="s">"/someGet"</span><span class="p">,</span> <span class="n">getting</span><span class="p">)</span>
	<span class="n">router</span><span class="o">.</span><span class="n">POST</span><span class="p">(</span><span class="s">"/somePost"</span><span class="p">,</span> <span class="n">posting</span><span class="p">)</span>
	<span class="n">router</span><span class="o">.</span><span class="n">PUT</span><span class="p">(</span><span class="s">"/somePut"</span><span class="p">,</span> <span class="n">putting</span><span class="p">)</span>
	<span class="n">router</span><span class="o">.</span><span class="n">DELETE</span><span class="p">(</span><span class="s">"/someDelete"</span><span class="p">,</span> <span class="n">deleting</span><span class="p">)</span>
	<span class="n">router</span><span class="o">.</span><span class="n">PATCH</span><span class="p">(</span><span class="s">"/somePatch"</span><span class="p">,</span> <span class="n">patching</span><span class="p">)</span>
	<span class="n">router</span><span class="o">.</span><span class="n">HEAD</span><span class="p">(</span><span class="s">"/someHead"</span><span class="p">,</span> <span class="n">head</span><span class="p">)</span>
	<span class="n">router</span><span class="o">.</span><span class="n">OPTIONS</span><span class="p">(</span><span class="s">"/someOptions"</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

	<span class="c">// By default it serves on :8080 unless a</span>
	<span class="c">// PORT environment variable was defined.</span>
	<span class="n">router</span><span class="o">.</span><span class="n">Run</span><span class="p">()</span>
	<span class="c">// router.Run(":3000") for a hard coded port</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ä¹ä¸€çœ‹ç®€å•åˆ°çˆ†ï¼Œä½†å®é™…ä½¿ç”¨ä¸­ï¼Œåœ¨è„šæ‰‹æ¶æ­å»ºä¸Šï¼Œæˆ‘ä»¬éœ€è¦è§„åˆ’å¥½ <strong>åŒ…ç»“æ„ã€é…ç½®æ–‡ä»¶ã€å‘½ä»¤è¡Œå‚æ•°ã€æ•°æ®åº“è¿æ¥ã€cache</strong> ç­‰ç­‰ï¼›ç›´åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè‡³å°‘æˆ‘æ²¡æœ‰æ‰¾åˆ°ä¸€ç§éå¸¸è§„èŒƒçš„åç«¯ MVC çš„æ ‡å‡†æ¶å­ç»“æ„ï¼›è¿™ç‚¹ç›®å‰ç¡®å®ä¸å¦‚ Java çš„ç”Ÿæ€ï¼›ä½œä¸ºæœ€åˆçš„è„šæ‰‹æ¶æ­å»ºè€…ï¼Œç«™åœ¨è¿™ä¸ªè§’åº¦ï¼Œæˆ‘æƒ³æˆ‘ä»¬æ›´åº”å½“è€ƒè™‘å¦‚ä½•åšå¥½é€‚å½“çš„æŠ½è±¡ã€éš”ç¦»ï¼›ä»¥é˜²æ­¢åé¢å¼€å‘è€…å¯¹ç³»ç»ŸåŸºç¡€åŠŸèƒ½å¯èƒ½é€ æˆçš„ç ´åã€‚</p>

<p>ç»¼ä¸Šæ‰€è¿°ï¼Œå†é…åˆ Gin æˆ–è€…è¯´ Go çš„ä»£ç é£æ ¼ï¼Œè¿™å°±å½¢æˆäº†ä¸€ç§å¼ºçƒˆçš„å†²çªï¼›åœ¨ Java ä¸­ï¼Œç”±äºæœ‰æ³¨è§£(<code class="highlighter-rouge">Annotation</code>)çš„å­˜åœ¨ï¼Œäº‹å®ä¸Šä½ æ˜¯å¯ä»¥æœ‰è¿™ç§æ“ä½œçš„: <strong>æ–°å»ºä¸€ä¸ª Classï¼Œåˆ›å»º funcï¼Œåœ¨ä¸Šé¢åŠ ä¸Šåˆé€‚çš„æ³¨è§£ï¼Œæœ€ç»ˆæ¡†æ¶ä¼šé€šè¿‡æ³¨è§£æ‰«æçš„æ–¹å¼ä»¥é€‚å½“çš„å½¢å¼è¿›è¡Œåˆå§‹åŒ–</strong>ï¼›è€Œ Go ä¸­å¹¶æ²¡æœ‰ <code class="highlighter-rouge">Annotation</code> è¿™ç©æ„ï¼Œæˆ‘ä»¬å¾ˆéš¾å®ç°åœ¨ <strong>ä»£ç è¿è¡Œæ—¶æ‰«æè‡ªèº«åšå‡ºä¸€ç§ç­–ç•¥æ€§è°ƒæ•´</strong>ï¼›ä»è€Œä¸‹é¢è¿™ä¸ªéœ€æ±‚å¾ˆéš¾å®ç°: <strong>ä½œä¸ºè„šæ‰‹æ¶æ­å»ºè€…ï¼Œæˆ‘å¸Œæœ›æˆ‘çš„åŸºç¡€ä»£ç å®‰å…¨çš„æ”¾åœ¨ä¸€ä¸ªç‰¹å®šä½ç½®ï¼Œåç»­å¼€å‘è€…å¼€å‘åº”å½“ä»¥ä¸€ç§ç±»ä¼¼å¯çƒ­æ’æ‹”çš„å½¢å¼æ³¨å…¥è¿›æ¥</strong>ï¼Œæ¯”å¦‚ Gin çš„ router è·¯ç”±è®¾ç½®ï¼Œæˆ‘ä¸å¸Œæœ›æ¯æ¬¡æœ‰ä¿®æ”¹éƒ½ä¼šæœ‰äººåŠ¨æˆ‘çš„ router æ ¸å¿ƒé…ç½®æ–‡ä»¶ã€‚</p>

<h3 id="äºŒcaddy-çš„å¥—è·¯">äºŒã€Caddy çš„å¥—è·¯</h3>

<p>åœ¨ç¿»äº† coredns çš„æºç åï¼Œæˆ‘å‘ç°ä»–æ˜¯ä¾èµ–äº Caddy è¿™æ¡†æ¶è¿è¡Œçš„ï¼Œcoredns çš„ä»£ç å†…çš„æ’ä»¶æœºåˆ¶ä¹Ÿæ˜¯ç›´æ¥è°ƒç”¨çš„ Caddyï¼›æ‰€ä»¥æ¥ç€æˆ‘å°±ç¿»åˆ°äº† Caddy æºç ï¼Œå…¶ä¸­çš„ä»£ç å¦‚ä¸‹(å®Œæ•´ä»£ç <a href="https://github.com/mholt/caddy/blob/master/plugins.go">ç‚¹å‡»è¿™é‡Œ</a>):</p>

<div class="language-golang highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">// RegisterPlugin plugs in plugin. All plugins should register</span>
<span class="c">// themselves, even if they do not perform an action associated</span>
<span class="c">// with a directive. It is important for the process to know</span>
<span class="c">// which plugins are available.</span>
<span class="c">//</span>
<span class="c">// The plugin MUST have a name: lower case and one word.</span>
<span class="c">// If this plugin has an action, it must be the name of</span>
<span class="c">// the directive that invokes it. A name is always required</span>
<span class="c">// and must be unique for the server type.</span>
<span class="k">func</span> <span class="n">RegisterPlugin</span><span class="p">(</span><span class="n">name</span> <span class="kt">string</span><span class="p">,</span> <span class="n">plugin</span> <span class="n">Plugin</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s">""</span> <span class="p">{</span>
		<span class="nb">panic</span><span class="p">(</span><span class="s">"plugin must have a name"</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="n">_</span><span class="p">,</span> <span class="n">ok</span> <span class="o">:=</span> <span class="n">plugins</span><span class="p">[</span><span class="n">plugin</span><span class="o">.</span><span class="n">ServerType</span><span class="p">];</span> <span class="o">!</span><span class="n">ok</span> <span class="p">{</span>
		<span class="n">plugins</span><span class="p">[</span><span class="n">plugin</span><span class="o">.</span><span class="n">ServerType</span><span class="p">]</span> <span class="o">=</span> <span class="nb">make</span><span class="p">(</span><span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="n">Plugin</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="n">_</span><span class="p">,</span> <span class="n">dup</span> <span class="o">:=</span> <span class="n">plugins</span><span class="p">[</span><span class="n">plugin</span><span class="o">.</span><span class="n">ServerType</span><span class="p">][</span><span class="n">name</span><span class="p">];</span> <span class="n">dup</span> <span class="p">{</span>
		<span class="nb">panic</span><span class="p">(</span><span class="s">"plugin named "</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">" already registered for server type "</span> <span class="o">+</span> <span class="n">plugin</span><span class="o">.</span><span class="n">ServerType</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="n">plugins</span><span class="p">[</span><span class="n">plugin</span><span class="o">.</span><span class="n">ServerType</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">plugin</span>
<span class="p">}</span>
</code></pre></div></div>

<p>å¥—è·¯å¾ˆæ¸…å¥‡ï¼Œä¸ºäº†å®ç°æˆ‘ä¸Šé¢è¯´çš„é‚£ä¸ªéœ€æ±‚: â€œåé¢å¼€å‘ä¸éœ€è¦åŠ¨æˆ‘æ ¸å¿ƒä»£ç ï¼Œæˆ‘è¿˜èƒ½å…è®¸ä»–ä»¬åŠ¨æ€æ·»åŠ â€ï¼ŒCaddy å¥—è·¯å°±æ˜¯<strong>å®šä¹‰ä¸€ä¸ª mapï¼Œmap é‡Œç”¨äºå­˜æ”¾ä¸€ç§ç‰¹å®šå½¢å¼çš„ funcï¼Œå¹¶ä¸”æš´éœ²å‡ºä¸€ä¸ªæ–¹æ³•ç”¨äºå‘ map å†…æ·»åŠ æŒ‡å®š funcï¼Œç„¶ååœ¨åˆé€‚çš„æ—¶æœºéå†è¿™ä¸ª mapï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„ funcã€‚</strong>è¿™ç§å¥—è·¯åˆ©ç”¨äº† Go å‡½æ•°å¼ç¼–ç¨‹çš„ç‰¹æ€§ï¼Œå°†è¡Œä¸ºå…ˆå­˜å‚¨åœ¨å®¹å™¨ä¸­ï¼Œç„¶ååç»­å†å»è°ƒç”¨è¿™äº›è¡Œä¸ºã€‚</p>

<h3 id="ä¸‰æ€»ç»“">ä¸‰ã€æ€»ç»“</h3>

<p>é•¿ç¯‡å¤§è®ºè¿™ä¹ˆä¹…ï¼Œå®é™…ä¸Šæˆ‘ä¹Ÿæ˜¯åœ¨ä¸€è¾¹æŠ˜è…¾ Go çš„è¿‡ç¨‹ä¸­ä¸€è¾¹æ€»ç»“å’Œå¯¹æ¯”è·Ÿ Java çš„å·®å¼‚ï¼›åœ¨ Java ä¸­æ‰«æè‡ªå·±æ³¨è§£çš„å¥—è·¯ Go ä¸­æ²¡æ³•å®ç°ï¼Œä½†æ˜¯ Go åˆ©ç”¨å…¶å‡½æ•°å¼ç¼–ç¨‹çš„ä¼˜åŠ¿ä¹Ÿå¯ä»¥åˆ©ç”¨ä¸€äº›å»¶è¿ŸåŠ è½½æ–¹å¼å®ç°å¯¹åº”çš„åŠŸèƒ½ï¼›æ€»ç»“æ¥è¯´ï¼Œä¸åŒè¯­è¨€æœ‰å…¶è‡ªå·±çš„ç‰¹æ€§ï¼Œå½“æœ‰å¯¹æ¯”çš„æ—¶å€™ï¼Œå¯èƒ½æ›´åŠ æ·±åˆ»ã€‚</p>

<p>è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼Œæœ¬æ–‡é‡‡ç”¨ <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/">CC4.0</a> åè®®æˆæƒ</p>
:ET