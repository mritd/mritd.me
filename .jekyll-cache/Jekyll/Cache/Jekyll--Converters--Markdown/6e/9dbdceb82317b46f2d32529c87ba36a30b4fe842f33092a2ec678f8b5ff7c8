I"îD<blockquote>
  <p>å¥½ä¹…æ²¡å†™æ–‡ç« äº†ï¼Œè¿‡å¹´ä»¥åå°±æœ‰ç‚¹æ‡’â€¦ æœ€è¿‘ä¹Ÿåœ¨å­¦ä¹  golangï¼Œå†åŠ ä¸Šä¸æ–­é€ è½®å­æ‰€ä»¥æ²¡å¤ªå¤šæ—¶é—´ï¼›å‡‘å·§æœ€è¿‘æƒ³æ§åˆ¶ä¸€ä¸‹ kubectl æƒé™ï¼Œè¿™é‡Œä¾¿è®°å½•ä¸€ä¸‹ã€‚</p>
</blockquote>

<h3 id="ä¸€rbac-ç›¸å…³">ä¸€ã€RBAC ç›¸å…³</h3>

<p>ç›¸ä¿¡ç°åœ¨å¤§éƒ¨åˆ†äººç”¨çš„é›†ç¾¤å·²ç»éƒ½æ˜¯ 1.6 ç‰ˆæœ¬ä»¥ä¸Šï¼Œè€Œä¸”åœ¨å®‰è£…å„ç§ç»„ä»¶çš„æ—¶å€™ä¹Ÿå·²ç»æˆ–å¤šæˆ–å°‘çš„å¤„ç†è¿‡ RBAC çš„ä¸œè¥¿ï¼Œæ‰€ä»¥è¿™é‡Œä¸åšå¤ªç»†èŠ‚æ€§çš„è®²è¿°ï¼ŒRBAC æ–‡æ¡£æˆ‘ä»¥å‰èƒ¡ä¹±ç¿»è¯‘è¿‡ä¸€ç¯‡ï¼Œè¯·çœ‹ <a href="https://mritd.me/2017/07/17/kubernetes-rbac-chinese-translation/">è¿™é‡Œ</a>ï¼Œä»¥ä¸‹å†…å®¹ä»…è¯´ä¸»è¦çš„</p>

<h4 id="11rbac-ç”¨æˆ·è§’è‰²ç›¸å…³">1.1ã€RBAC ç”¨æˆ·è§’è‰²ç›¸å…³</h4>

<p>æˆ‘åœ¨ç¬¬ä¸€æ¬¡æ¥è§¦ Kubernetes RBAC çš„æ—¶å€™ï¼Œå¯¹äºåŸºäºè§’è‰²æ§åˆ¶æƒé™è¿™ç§åšæ³•æ˜¯æœ‰äº†è§£çš„ï¼ŒåŸºæœ¬ç»“æ„ä¸»è¦å°±æ˜¯ä¸‰ä¸ª:</p>

<ul>
  <li>æƒé™: å³å¯¹ç³»ç»Ÿä¸­æŒ‡å®šèµ„æºçš„å¢åˆ æ”¹æŸ¥æƒé™</li>
  <li>è§’è‰²: å°†ä¸€å®šçš„æƒé™ç»„åˆåœ¨ä¸€èµ·äº§ç”Ÿæƒé™ç»„ï¼Œå¦‚ç®¡ç†å‘˜è§’è‰²</li>
  <li>ç”¨æˆ·: å…·ä½“çš„ä½¿ç”¨è€…ï¼Œå…·æœ‰å”¯ä¸€èº«ä»½æ ‡è¯†(ID)ï¼Œå…¶åä¸è§’è‰²ç»‘å®šä¾¿æ‹¥æœ‰è§’è‰²çš„å¯¹åº”æƒé™</li>
</ul>

<p>ä½†æ˜¯ç¿»äº†ä¸€ä¼šæ–‡æ¡£ï¼Œæœ€æ™•çš„å°±æ˜¯ <strong>è¿™ä¸ªç”¨æˆ·æ ‡è¯†(ID)å­˜åœ¨å“ª</strong>ï¼Œå› ä¸ºä¼ ç»Ÿçš„æˆæƒæ¨¡å‹éƒ½æ˜¯ä¸‹é¢è¿™æ ·</p>

<p><img src="https://cdn.oss.link/markdown/sn1qp.png" alt="ctrole" /></p>

<p>ä¸è®ºæ€æ ·ï¼Œåœ¨è¿›è¡Œæˆæƒæ—¶æ€»è¦æœ‰ä¸ªåœ°æ–¹å­˜æ”¾ç”¨æˆ·ä¿¡æ¯(DB/æ–‡ä»¶)ï¼Œä½†æ˜¯åœ¨ Kubernetes é‡Œå´æ²¡æ‰¾åˆ°ï¼›åæ¥ç¿»é˜…æ–‡æ¡£ï¼Œæ‰¾åˆ°<a href="https://kubernetes.io/docs/admin/authentication/">è¿™ä¹ˆä¸€æ®µ</a></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Normal users are assumed to be managed by an outside, independent service. An admin distributing private keys, a user store like Keystone or Google Accounts, even a file with a list of usernames and passwords.
</code></pre></div></div>

<p><strong>ä¹Ÿå°±æ˜¯è¯´ï¼ŒKubernetes æ˜¯ä¸è´Ÿè´£ç»´æŠ¤å­˜å‚¨ç”¨æˆ·æ•°æ®çš„ï¼›å¯¹äº Kubernetes æ¥è¯´ï¼Œå®ƒè¯†åˆ«æˆ–è€…è¯´è®¤è¯†ä¸€ä¸ªç”¨æˆ·ä¸»è¦å°±å‡ ç§æ–¹å¼</strong></p>

<ul>
  <li>X509 Client Certs: ä½¿ç”¨ç”± k8s æ ¹ CA ç­¾å‘çš„è¯ä¹¦ï¼Œæå– O å­—æ®µ</li>
  <li>Static Token File: é¢„å…ˆåœ¨ API Server æ”¾ç½® Token æ–‡ä»¶(bootstrap é˜¶æ®µä½¿ç”¨è¿‡)</li>
  <li>Bootstrap Tokens: ä¸€ç§åœ¨é›†ç¾¤å†…åˆ›å»ºçš„ Bootstrap ä¸“ç”¨ Token(æ–°çš„ Bootstarp æ¨è)</li>
  <li>Static Password File: è·Ÿé™æ€ Token ç±»ä¼¼</li>
  <li>Service Account Tokens: ä½¿ç”¨ Service Account çš„ Token</li>
</ul>

<p>å…¶ä»–ä¸å†ä¸€ä¸€åˆ—ä¸¾ï¼Œå…·ä½“è¯·çœ‹æ–‡æ¡£ <a href="https://kubernetes.io/docs/admin/authentication/">Authenticating</a>ï¼›äº†è§£äº†è¿™äº›ï¼Œåé¢æˆ‘ä»¬ä½¿ç”¨ RBAC æ§åˆ¶ kubectl æƒé™çš„æ—¶å€™å°±è¦ä½¿ç”¨å¦‚ä¸Šå‡ ç§æ–¹æ³•åˆ›å»ºå¯¹åº”ç”¨æˆ·</p>

<h4 id="12rbac-æƒé™ç›¸å…³">1.2ã€RBAC æƒé™ç›¸å…³</h4>

<p>RBAC æƒé™å®šä¹‰éƒ¨åˆ†ä¸»è¦æœ‰ä¸‰ä¸ªå±‚çº§</p>

<ul>
  <li>apiGroups: æŒ‡å®šé‚£ä¸ª API ç»„ä¸‹çš„æƒé™</li>
  <li>resources: è¯¥ç»„ä¸‹å…·ä½“èµ„æºï¼Œå¦‚ pod ç­‰</li>
  <li>verbs: æŒ‡å¯¹è¯¥èµ„æºå…·ä½“æ‰§è¡Œå“ªäº›åŠ¨ä½œ</li>
</ul>

<p>å®šä¹‰ä¸€ç»„æƒé™(è§’è‰²)æ—¶è¦æ ¹æ®å…¶æ‰€éœ€çš„çœŸæ­£éœ€æ±‚åšæœ€ç»†ç²’åº¦çš„åˆ’åˆ†</p>

<h3 id="äºŒåˆ›å»ºä¸€ä¸ªåªè¯»çš„ç”¨æˆ·">äºŒã€åˆ›å»ºä¸€ä¸ªåªè¯»çš„ç”¨æˆ·</h3>

<h4 id="21åˆ›å»ºç”¨æˆ·">2.1ã€åˆ›å»ºç”¨æˆ·</h4>

<p>é¦–å…ˆæ ¹æ®ä¸Šæ–‡å¯ä»¥å¾—çŸ¥ï¼ŒKubernetes ä¸å­˜å‚¨ç”¨æˆ·å…·ä½“ç»†èŠ‚ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯è¯´åªè¦é€šè¿‡å®ƒçš„é‚£å‡ ç§æ–¹å¼èƒ½è¿›æ¥çš„ç”¨æˆ·ï¼ŒKubernetes å°±è®¤ä¸ºå®ƒæ˜¯åˆæ³•çš„ï¼›é‚£ä¹ˆä¸ºäº†è®© kubectl åªè¯»ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å…ˆç»™å®ƒåˆ›å»ºä¸€ä¸ªç”¨æ¥æ‰¿è½½åªè¯»æƒé™çš„ç”¨æˆ·ï¼›è¿™é‡Œç”¨æˆ·åˆ›å»ºæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨è¯ä¹¦æ–¹å¼</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># é¦–å…ˆå…ˆåˆ›å»ºä¸€ä¸ªç”¨äºç­¾å‘è¯ä¹¦çš„ json(è¯ä¹¦åˆ›å»ºä½¿ç”¨ cfssl)</span>
<span class="o">{</span>
  <span class="s2">"CN"</span>: <span class="s2">"readonly"</span>,
  <span class="s2">"hosts"</span>: <span class="o">[]</span>,
  <span class="s2">"key"</span>: <span class="o">{</span>
    <span class="s2">"algo"</span>: <span class="s2">"rsa"</span>,
    <span class="s2">"size"</span>: 2048
  <span class="o">}</span>,
  <span class="s2">"names"</span>: <span class="o">[</span>
    <span class="o">{</span>
      <span class="s2">"C"</span>: <span class="s2">"CN"</span>,
      <span class="s2">"ST"</span>: <span class="s2">"BeiJing"</span>,
      <span class="s2">"L"</span>: <span class="s2">"BeiJing"</span>,
      <span class="s2">"O"</span>: <span class="s2">"develop:readonly"</span>,
      <span class="s2">"OU"</span>: <span class="s2">"develop"</span>
    <span class="o">}</span>
  <span class="o">]</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ç„¶ååŸºäºä»¥ Kubernetes CA è¯ä¹¦åˆ›å»ºåªè¯»ç”¨æˆ·çš„è¯ä¹¦</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cfssl gencert <span class="nt">--ca</span> /etc/kubernetes/ssl/k8s-root-ca.pem <span class="se">\</span>
              <span class="nt">--ca-key</span> /etc/kubernetes/ssl/k8s-root-ca-key.pem <span class="se">\</span>
              <span class="nt">--config</span> k8s-gencert.json <span class="se">\</span>
              <span class="nt">--profile</span> kubernetes readonly.json | <span class="se">\</span>
              cfssljson <span class="nt">--bare</span> <span class="nb">readonly</span>
</code></pre></div></div>

<p>ä»¥ä¸Šå‘½ä»¤ä¼šç”Ÿæˆ <code class="highlighter-rouge">readonly-key.pem</code>ã€<code class="highlighter-rouge">readonly.pem</code> ä¸¤ä¸ªè¯ä¹¦æ–‡ä»¶ä»¥åŠä¸€ä¸ª csr è¯·æ±‚æ–‡ä»¶</p>

<h4 id="22åˆ›å»º-kubeconfig">2.2ã€åˆ›å»º kubeconfig</h4>

<p>æœ‰äº†ç”¨äºè¯æ˜èº«ä»½çš„è¯ä¹¦ä»¥åï¼Œæ¥ä¸‹æ¥åˆ›å»ºä¸€ä¸ª kubeconfig æ–‡ä»¶æ–¹ä¾¿ kubectl ä½¿ç”¨</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

<span class="nv">KUBE_API_SERVER</span><span class="o">=</span><span class="s2">"https://172.16.0.18:6443"</span>
<span class="nv">CERT_DIR</span><span class="o">=</span><span class="k">${</span><span class="nv">2</span><span class="k">:-</span><span class="s2">"/etc/kubernetes/ssl"</span><span class="k">}</span>

kubectl config set-cluster default-cluster <span class="nt">--server</span><span class="o">=</span><span class="k">${</span><span class="nv">KUBE_API_SERVER</span><span class="k">}</span> <span class="se">\</span>
    <span class="nt">--certificate-authority</span><span class="o">=</span><span class="k">${</span><span class="nv">CERT_DIR</span><span class="k">}</span>/k8s-root-ca.pem <span class="se">\</span>
    <span class="nt">--embed-certs</span><span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
    <span class="nt">--kubeconfig</span><span class="o">=</span>readonly.kubeconfig

kubectl config set-credentials develop-readonly <span class="se">\</span>
    <span class="nt">--certificate-authority</span><span class="o">=</span><span class="k">${</span><span class="nv">CERT_DIR</span><span class="k">}</span>/k8s-root-ca.pem <span class="se">\</span>
    <span class="nt">--embed-certs</span><span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
    <span class="nt">--client-key</span><span class="o">=</span>readonly-key.pem <span class="se">\</span>
    <span class="nt">--client-certificate</span><span class="o">=</span>readonly.pem <span class="se">\</span>
    <span class="nt">--kubeconfig</span><span class="o">=</span>readonly.kubeconfig

kubectl config set-context default-system <span class="nt">--cluster</span><span class="o">=</span>default-cluster <span class="se">\</span>
    <span class="nt">--user</span><span class="o">=</span>develop-readonly <span class="se">\</span>
    <span class="nt">--kubeconfig</span><span class="o">=</span>readonly.kubeconfig

kubectl config use-context default-system <span class="nt">--kubeconfig</span><span class="o">=</span>readonly.kubeconfig
</code></pre></div></div>

<p>è¿™æ¡å‘½ä»¤ä¼šå°†è¯ä¹¦ä¹Ÿå†™å…¥åˆ° readonly.kubeconfig é…ç½®æ–‡ä»¶ä¸­ï¼Œå°†è¯¥æ–‡ä»¶æ”¾åœ¨ <code class="highlighter-rouge">~/.kube/config</code> ä½ç½®ï¼Œkubectl ä¼šè‡ªåŠ¨è¯»å–</p>

<h4 id="23åˆ›å»º-clusterrole">2.3ã€åˆ›å»º ClusterRole</h4>

<p>æœ¬ç¤ºä¾‹åˆ›å»ºçš„åªè¯»ç”¨æˆ·æƒé™èŒƒå›´ä¸º Cluster é›†ç¾¤èŒƒå›´ï¼Œæ‰€ä»¥å…ˆåˆ›å»ºä¸€ä¸ªåªè¯»æƒé™çš„ ClusterRoleï¼›åˆ›å»º ClusterRole ä¸çŸ¥é“éƒ½æœ‰å“ªäº›æƒé™çš„è¯ï¼Œæœ€ç®€å•çš„åŠæ³•æ˜¯å°†é›†ç¾¤çš„ admin ClusterRole ä¿å­˜å‡ºæ¥ï¼Œç„¶ååšä¿®æ”¹</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># å¯¼å‡º admin ClusterRole</span>
kubectl get clusterrole admin <span class="nt">-o</span> yaml <span class="o">&gt;</span> readonly.yaml
</code></pre></div></div>

<p>è¿™ä¸ª admin ClusterRole æ˜¯é»˜è®¤å­˜åœ¨çš„ï¼Œå¯¼å‡ºåæˆ‘ä»¬æ ¹æ®è‡ªå·±éœ€æ±‚ä¿®æ”¹å°±è¡Œï¼›æœ€åŸºæœ¬çš„åŸåˆ™å°±æ˜¯åƒ updateã€delete è¿™ç§æƒé™å¿…é¡»åˆ æ‰(æˆ‘ä»¬è¦åˆ›å»ºåªè¯»ç”¨æˆ·)ï¼Œä¿®æ”¹åå¦‚ä¸‹</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ClusterRole</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">cluster-readonly</span>
<span class="na">rules</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">apiGroups</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">"</span>
  <span class="na">resources</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">pods</span>
  <span class="pi">-</span> <span class="s">pods/attach</span>
  <span class="pi">-</span> <span class="s">pods/exec</span>
  <span class="pi">-</span> <span class="s">pods/portforward</span>
  <span class="pi">-</span> <span class="s">pods/proxy</span>
  <span class="na">verbs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">get</span>
  <span class="pi">-</span> <span class="s">list</span>
  <span class="pi">-</span> <span class="s">watch</span>
<span class="pi">-</span> <span class="na">apiGroups</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">"</span>
  <span class="na">resources</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">configmaps</span>
  <span class="pi">-</span> <span class="s">endpoints</span>
  <span class="pi">-</span> <span class="s">persistentvolumeclaims</span>
  <span class="pi">-</span> <span class="s">replicationcontrollers</span>
  <span class="pi">-</span> <span class="s">replicationcontrollers/scale</span>
  <span class="pi">-</span> <span class="s">secrets</span>
  <span class="pi">-</span> <span class="s">serviceaccounts</span>
  <span class="pi">-</span> <span class="s">services</span>
  <span class="pi">-</span> <span class="s">services/proxy</span>
  <span class="na">verbs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">get</span>
  <span class="pi">-</span> <span class="s">list</span>
  <span class="pi">-</span> <span class="s">watch</span>
<span class="pi">-</span> <span class="na">apiGroups</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">"</span>
  <span class="na">resources</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">bindings</span>
  <span class="pi">-</span> <span class="s">events</span>
  <span class="pi">-</span> <span class="s">limitranges</span>
  <span class="pi">-</span> <span class="s">namespaces/status</span>
  <span class="pi">-</span> <span class="s">pods/log</span>
  <span class="pi">-</span> <span class="s">pods/status</span>
  <span class="pi">-</span> <span class="s">replicationcontrollers/status</span>
  <span class="pi">-</span> <span class="s">resourcequotas</span>
  <span class="pi">-</span> <span class="s">resourcequotas/status</span>
  <span class="na">verbs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">get</span>
  <span class="pi">-</span> <span class="s">list</span>
  <span class="pi">-</span> <span class="s">watch</span>
<span class="pi">-</span> <span class="na">apiGroups</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">"</span>
  <span class="na">resources</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">namespaces</span>
  <span class="na">verbs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">get</span>
  <span class="pi">-</span> <span class="s">list</span>
  <span class="pi">-</span> <span class="s">watch</span>
<span class="pi">-</span> <span class="na">apiGroups</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">apps</span>
  <span class="na">resources</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">deployments</span>
  <span class="pi">-</span> <span class="s">deployments/rollback</span>
  <span class="pi">-</span> <span class="s">deployments/scale</span>
  <span class="pi">-</span> <span class="s">statefulsets</span>
  <span class="na">verbs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">get</span>
  <span class="pi">-</span> <span class="s">list</span>
  <span class="pi">-</span> <span class="s">watch</span>
<span class="pi">-</span> <span class="na">apiGroups</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">autoscaling</span>
  <span class="na">resources</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">horizontalpodautoscalers</span>
  <span class="na">verbs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">get</span>
  <span class="pi">-</span> <span class="s">list</span>
  <span class="pi">-</span> <span class="s">watch</span>
<span class="pi">-</span> <span class="na">apiGroups</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">batch</span>
  <span class="na">resources</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">cronjobs</span>
  <span class="pi">-</span> <span class="s">jobs</span>
  <span class="pi">-</span> <span class="s">scheduledjobs</span>
  <span class="na">verbs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">get</span>
  <span class="pi">-</span> <span class="s">list</span>
  <span class="pi">-</span> <span class="s">watch</span>
<span class="pi">-</span> <span class="na">apiGroups</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">extensions</span>
  <span class="na">resources</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">daemonsets</span>
  <span class="pi">-</span> <span class="s">deployments</span>
  <span class="pi">-</span> <span class="s">ingresses</span>
  <span class="pi">-</span> <span class="s">replicasets</span>
  <span class="na">verbs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">get</span>
  <span class="pi">-</span> <span class="s">list</span>
  <span class="pi">-</span> <span class="s">watch</span>
</code></pre></div></div>

<p>æœ€åæ‰§è¡Œ <code class="highlighter-rouge">kubectl create -f readonly.yaml</code> åˆ›å»ºå³å¯</p>

<h4 id="24åˆ›å»º-clusterrolebinding">2.4ã€åˆ›å»º ClusterRoleBinding</h4>

<p>ç”¨æˆ·å·²ç»åˆ›å»ºå®Œæˆï¼Œé›†ç¾¤æƒé™ä¹Ÿæœ‰äº†ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨ ClusterRoleBinding ç»‘å®šåˆ°ä¸€èµ·å³å¯</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ClusterRoleBinding</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">cluster-readonly</span>
<span class="na">roleRef</span><span class="pi">:</span>
  <span class="na">apiGroup</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io</span>
  <span class="na">kind</span><span class="pi">:</span> <span class="s">ClusterRole</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">cluster-readonly</span>
<span class="na">subjects</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">apiGroup</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io</span>
  <span class="na">kind</span><span class="pi">:</span> <span class="s">Group</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">develop:readonly</span>
</code></pre></div></div>

<p>å°†ä»¥ä¸Šä¿å­˜ä¸º <code class="highlighter-rouge">readonly-bind.yaml</code> æ‰§è¡Œ <code class="highlighter-rouge">kubectl create -f readonly-bind.yaml</code> å³å¯</p>

<h4 id="25æµ‹è¯•æƒé™">2.5ã€æµ‹è¯•æƒé™</h4>

<p>å°†æœ€åˆåˆ›å»ºçš„ kubeconfig æ”¾åˆ° <code class="highlighter-rouge">~/.kube/config</code> æˆ–è€…ç›´æ¥ä½¿ç”¨ <code class="highlighter-rouge">--kubeconfig</code> é€‰é¡¹æµ‹è¯•è¯»å–ã€åˆ é™¤ pod ç­‰æƒé™å³å¯ï¼Œæµ‹è¯•åå¦‚ä¸‹æ‰€ç¤º</p>

<p><img src="https://cdn.oss.link/markdown/68ukm.png" alt="test readonly" /></p>

<p>è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼Œæœ¬æ–‡é‡‡ç”¨ <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/">CC4.0</a> åè®®æˆæƒ</p>
:ET